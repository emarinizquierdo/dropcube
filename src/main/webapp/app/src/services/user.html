<dom-module id="user-service">

    <template>
        <iron-cookie name="JSESSIONID" value="{{value}}" uri-safe expires="{{expires}}"></iron-cookie>
        <iron-ajax auto url="/s/users/me"  handle-as="json" on-response="_onResponse" last-response="{{userData}}"></iron-ajax>
    </template>



    <script>

        function User() {

            this.data = null;

            this.isAdmin = function() {
                return (this.data.role == 'ADMIN');
            }

            this.isLogged = false;

        }

        // element registration
        Polymer({
            is: "user-service",
            properties: {
                user: {
                    type: Object,
                    notify: true,
                    value : new User()
                }
            },

            _onResponse : function(data){
              if(this.userData){
                this.userData.isLogged = true;
              }

              this.set('user', this.userData);
            }

        });
    </script>

</dom-module>
